<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlightPlus - Shared Flight Album</title>
    
    <!-- Universal Links / Deep Linking Support -->
    <!-- Smart App Banner - Shows automatic App Store banner in Safari when app is not installed -->
    <meta name="apple-itunes-app" content="app-id=6749645650">
    
    <!-- Prevent automatic redirects that might interfere with Universal Links -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="FlightPlus - Shared Flight Album">
    <meta property="og:description" content="Download FlightPlus to view this shared flight album">
    <meta property="og:url" content="" id="og-url">
    <meta property="og:site_name" content="FlightPlus">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="FlightPlus - Shared Flight Album">
    <meta name="twitter:description" content="Download FlightPlus to view this shared flight album">
    
    <!-- Canonical URL - Helps iOS recognize the link -->
    <link rel="canonical" href="" id="canonical-url">
    
    <!-- Prevent indexing - This is a deep link page, not content -->
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Preconnect to domain for faster Universal Link recognition -->
    <link rel="preconnect" href="https://flightplus.ai">
    
    <!-- Base URL to ensure relative paths work correctly -->
    <base href="https://flightplus.ai/">
    
    <!-- Google Fonts - Inter (same as main site) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Reset and base styles - matching main website */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.47059;
            color: #1d1d1f;
            background-color: #ffffff;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .container {
            max-width: 500px;
            text-align: center;
            animation: fadeInUp 0.8s ease-out;
        }

        .app-icon {
            width: 100px;
            height: 100px;
            margin: 0 auto 1.5rem;
            border-radius: 22px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }

        h1 {
            font-size: clamp(1.75rem, 4vw, 2.5rem);
            font-weight: 600;
            letter-spacing: -0.03em;
            line-height: 1.1;
            margin-bottom: 1rem;
            color: #1d1d1f;
        }

        .tagline {
            font-size: clamp(1rem, 2vw, 1.25rem);
            font-weight: 400;
            letter-spacing: -0.01em;
            line-height: 1.4;
            color: #1d1d1f;
            margin-bottom: 0.5rem;
        }

        .description {
            font-size: clamp(0.875rem, 1.5vw, 1rem);
            font-weight: 400;
            line-height: 1.5;
            color: #86868b;
            margin-bottom: 2rem;
        }

        /* Spinner */
        .spinner-container {
            margin: 2rem 0;
        }

        .spinner {
            border: 3px solid #f0f0f0;
            border-top: 3px solid #1d1d1f;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* App Store badge - matching main website style */
        .app-store-badge {
            display: inline-block;
            margin-top: 0.5rem;
            animation: fadeInUp 0.8s ease-out 0.3s both;
        }

        .app-store-badge img {
            height: 54px;
            width: auto;
            transition: transform 0.3s ease;
        }

        .app-store-badge:hover img {
            transform: scale(1.05);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Footer note */
        .footer-note {
            margin-top: 3rem;
            font-size: 0.75rem;
            color: #86868b;
            line-height: 1.5;
        }

        .footer-note a {
            color: #0066cc;
            text-decoration: none;
        }

        .footer-note a:hover {
            text-decoration: underline;
        }

        /* Hidden elements initially */
        .hidden {
            display: none;
        }
    </style>
    <script>
        // Extract shareId from URL path
        const path = window.location.pathname;
        const shareIdMatch = path.match(/\/share\/([^\/]+)/);
        const shareId = shareIdMatch ? shareIdMatch[1] : null;
        
        // App Store URL
        const APP_STORE_URL = 'https://apps.apple.com/app/id6749645650';
        
        // Detect iOS device
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        
        // Run after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            if (shareId) {
                // Set canonical URL and Open Graph URL
                const currentUrl = window.location.href;
                const canonicalLink = document.getElementById('canonical-url');
                const ogUrlMeta = document.getElementById('og-url');
                if (canonicalLink) canonicalLink.setAttribute('href', currentUrl);
                if (ogUrlMeta) ogUrlMeta.setAttribute('content', currentUrl);
                
                // On iOS, try to open the app via custom URL scheme
                if (isIOS) {
                    const customSchemeUrl = 'flightplus://share/' + shareId;
                    
                    // Use an iframe to attempt opening the app without navigating away
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = customSchemeUrl;
                    document.body.appendChild(iframe);
                    
                    // Clean up iframe after attempt
                    setTimeout(function() {
                        if (iframe.parentNode) {
                            iframe.parentNode.removeChild(iframe);
                        }
                    }, 1000);
                }
                
                // Track if user is still on page (app didn't open)
                let stillOnPage = true;
                
                // Check if page becomes hidden (app opened)
                document.addEventListener('visibilitychange', function() {
                    if (document.hidden) {
                        stillOnPage = false;
                    }
                });
                
                window.addEventListener('pagehide', function() {
                    stillOnPage = false;
                });
                
                // After delay, hide spinner and show content
                const showContentDelay = 1000; // 1 second - spinner hides, App Store badge appears
                const autoRedirectDelay = 3000; // 3 seconds - auto-redirects to App Store
                
                setTimeout(function() {
                    if (!stillOnPage) return;
                    
                    // Hide spinner
                    const spinner = document.querySelector('.spinner-container');
                    if (spinner) spinner.style.display = 'none';
                    
                    // Show App Store badge
                    const badge = document.querySelector('.app-store-badge');
                    if (badge) badge.classList.remove('hidden');
                    
                    // Show footer
                    const footer = document.querySelector('.footer-note');
                    if (footer) footer.classList.remove('hidden');
                    
                }, showContentDelay);
                
                // Auto-redirect to App Store after delay
                setTimeout(function() {
                    if (stillOnPage && !document.hidden) {
                        const description = document.querySelector('.description');
                        if (description) {
                            description.textContent = 'Redirecting to App Store...';
                        }
                        setTimeout(function() {
                            window.location.href = APP_STORE_URL;
                        }, 500);
                    }
                }, autoRedirectDelay);
                
            } else {
                // Not a share link - show generic welcome
                const tagline = document.querySelector('.tagline');
                const description = document.querySelector('.description');
                const spinner = document.querySelector('.spinner-container');
                const badge = document.querySelector('.app-store-badge');
                const footer = document.querySelector('.footer-note');
                
                if (tagline) tagline.textContent = 'Your AI Flight Companion';
                if (description) description.textContent = 'Log your flights, map your aerial photos, and share your aviation adventures.';
                if (spinner) spinner.style.display = 'none';
                if (badge) badge.classList.remove('hidden');
                if (footer) footer.classList.remove('hidden');
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <img src="app-icon.png" alt="FlightPlus" class="app-icon" onerror="this.onerror=null; this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIHJ4PSIyMiIgZmlsbD0iIzAwN0FGQiIvPjxwYXRoIGQ9Ik01MCAzNUw0MCA1MEw1MCA2NUw2MCA1MEw1MCAzNVoiIGZpbGw9IndoaXRlIi8+PC9zdmc+';">
        <h1>FlightPlus</h1>
        <p class="tagline">Shared Flight Album</p>
        <p class="description">Download FlightPlus to view this shared flight album and explore the journey.</p>
        
        <div class="spinner-container">
            <div class="spinner"></div>
        </div>
        
        <div class="app-store-badge hidden">
            <a href="https://apps.apple.com/app/id6749645650" target="_blank" rel="noopener noreferrer">
                <img src="https://tools.applemediaservices.com/api/badges/download-on-the-app-store/black/en-us?size=250x83&releaseDate=1276560000" 
                     alt="Download on the App Store" 
                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUwIiBoZWlnaHQ9IjgzIiB2aWV3Qm94PSIwIDAgMjUwIDgzIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIyNTAiIGhlaWdodD0iODMiIHJ4PSIxMiIgZmlsbD0iIzAwMCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiNGRkYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5Eb3dubG9hZCBvbiB0aGUgQXBwIFN0b3JlPC90ZXh0Pjwvc3ZnPg=='">
            </a>
        </div>
        
        <p class="footer-note hidden">
            Learn more at <a href="https://flightplus.ai">flightplus.ai</a>
        </p>
    </div>
</body>
</html>
